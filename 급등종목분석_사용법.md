# 급등종목 분석 리포트 생성 방법

## 📋 개요

`analyze_topgainers.py`는 인포스탁 급등종목 HTML 파일을 자동으로 분석하여 마크다운 리포트를 생성하는 스크립트입니다.

---

## 🚀 사용 방법

### 1. 기본 실행

```bash
python analyze_topgainers.py YYYY-MM-DD
```

**예시:**
```bash
python analyze_topgainers.py 2025-10-27
```

### 2. 가상환경 사용 시

```bash
./venv/Scripts/python analyze_topgainers.py 2025-10-27
```

---

## 📁 파일 구조

### 입력 파일
- **위치**: `data/YYYY-MM-DD/topgainers.html`
- **형식**: 인포스탁 증시요약 페이지 HTML
- **준비**: 인포스탁에서 해당 날짜의 급등종목 페이지를 HTML로 저장

### 출력 파일
- **위치**: `report/YYYY-MM-DD/topgainers.md`
- **형식**: 마크다운 리포트
- **내용**:
  - 주요 급등 테마 분석 (키워드 기반)
  - 시장 분석 (평균 상승률, 최고 상승률)
  - 요약 통계
  - 상한가 종목 테이블 (거래대금 500억원 이상)
  - 급등종목 테이블 (상한가 제외, 거래대금 500억원 이상)

---

## 📊 리포트 내용

### 1. 주요 급등 테마 분석
- AI/로봇, 반도체, 전력/에너지 등 키워드 기반 자동 분류
- 각 테마별 관련 종목 수와 주요 종목 표시

### 2. 시장 분석
- 전체 급등종목 수
- 평균 상승률
- 최고 상승률 종목

### 3. 상한가 종목
- 거래대금 500억원 이상만 표시
- 현재가, 상승률, 거래대금, 상한가 일수, 급등 사유 포함

### 4. 급등종목 TOP
- 상한가 제외, 거래대금 500억원 이상만 표시
- 현재가, 상승률, 거래대금, 급등 사유 포함

---

## ⚠️ 주의사항

### 1. 날짜 제약
- **KRX(한국거래소) 데이터가 있는 날짜만 사용 가능**
- 영업일 기준 당일 또는 과거 날짜만 가능
- 주말/공휴일은 데이터가 없으므로 거래대금 조회 실패

### 2. 거래대금 필터링
- 거래대금 500억원 미만 종목은 자동 제외
- 거래대금 조회 실패 시 해당 종목 제외

### 3. 급등 사유
- 원문 그대로 표시 (60자 제한)
- 60자 초과 시 "..." 으로 표시

---

## 🔧 수동 개선 워크플로우

### 1단계: 자동 리포트 생성
```bash
python analyze_topgainers.py 2025-10-27
```

### 2단계: 생성된 리포트 확인
```bash
# 파일 열기
notepad report/2025-10-27/topgainers.md

# 또는 VS Code로 열기
code report/2025-10-27/topgainers.md
```

### 3단계: 필요시 Claude에게 개선 요청
생성된 리포트를 Claude Code에 제공하고 다음과 같이 요청:

```
이 리포트를 더 읽기 쉽게 개선해줘:
- 급등 사유를 더 간결하게 요약
- 테마 분석에 인사이트 추가
- 시장 동향 요약문 작성
```

---

## 💡 팁

### 빠른 실행
배치 파일 생성 (`run_topgainers.bat`):
```batch
@echo off
set /p DATE=날짜 입력 (YYYY-MM-DD):
./venv/Scripts/python analyze_topgainers.py %DATE%
pause
```

실행:
```bash
run_topgainers.bat
```

### 여러 날짜 일괄 처리
```bash
# 반복문으로 여러 날짜 처리
for date in 2025-10-27 2025-10-28 2025-10-29; do
    python analyze_topgainers.py $date
done
```

---

## 🐛 문제 해결

### "파일을 찾을 수 없음" 오류
```
오류: 'data/YYYY-MM-DD/topgainers.html' 파일을 찾을 수 없습니다.
```
**해결**: 해당 날짜의 HTML 파일을 먼저 저장하세요.

### "거래대금 오류" 발생
```
오류 - '거래대금'
```
**원인**: KRX에 해당 날짜 데이터가 없음 (미래 날짜 또는 비영업일)
**해결**: 영업일 날짜를 사용하세요.

### 종목이 0개로 표시
**원인**: 모든 종목의 거래대금이 500억원 미만이거나 조회 실패
**해결**:
1. 날짜가 올바른지 확인
2. 영업일인지 확인
3. HTML 파일이 올바르게 저장되었는지 확인

---

## 📞 추가 지원

필요한 기능이나 개선 사항이 있으면 Claude Code에 요청하세요!
