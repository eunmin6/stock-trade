# 주문 데이터 분석 이슈 리포트

**작성일**: 2025-11-05
**작업 내용**: all-orders.xlsx를 사용하여 모든 날짜의 trading report에 시간 정보 추가 시도

---

## 🔍 발견한 문제

### 1. 파일 구조 불일치

**2025-11-05.xlsx** (정상 동작):
- 17개 컬럼
- 컬럼 구조:
  - [2] 종목명
  - [3] 매매구분 (매수/매도)
  - [11] 상태 (체결/미체결)
  - [14] 주문시간 (HH:MM:SS)

**all-orders.xlsx** (호환 안됨):
- 11개 컬럼
- 완전히 다른 구조:
  - [1] 주문번호/상태 (한글 텍스트)
  - [4] 숫자 값 (종목명이 아님)
  - [5] 숫자 값 (가격으로 추정)
  - [9] 체결시간 (HH:MM:SS) - 이것만 동일

### 2. 데이터 추출 실패

all-orders.xlsx에서 다음 정보를 추출할 수 없음:
- ❌ 종목명
- ❌ 매매구분 (매수/매도)
- ✅ 체결시간 (있으나 종목과 매칭 불가)

---

## 💡 해결 방안

### 방안 1: 날짜별 개별 파일 사용 (권장)

각 날짜별로 `2025-MM-DD.xlsx` 형식의 파일이 있다면:

```
data/orders/
├── 2025-10-23.xlsx
├── 2025-10-27.xlsx
├── 2025-10-28.xlsx
├── ...
└── 2025-11-05.xlsx (이미 있음)
```

이 경우 다음 스크립트로 자동 처리 가능:

```python
# scripts/update_all_reports_from_individual_files.py
for date in dates:
    orders = pd.read_excel(f'data/orders/{date}.xlsx')
    timing_info = extract_timing(orders)
    update_md_file(f'report/tradings/{date}.md', timing_info)
```

### 방안 2: all-orders.xlsx 구조 변환

all-orders.xlsx를 2025-11-05.xlsx와 같은 형식으로 변환:
1. 증권사 거래 내역에서 재다운로드
2. 또는 all-orders.xlsx의 실제 구조 파악 후 파싱 로직 개발

### 방안 3: 수동 업데이트

현재 2025-11-05.md만 업데이트되어 있으므로:
- 나머지 날짜는 시간 정보 없이 사용
- 또는 각 날짜별로 개별 xlsx 파일 생성 후 처리

---

## 🎯 추천 방향

**1순위**: 각 날짜별 개별 xlsx 파일 생성
- 2025-11-05.xlsx와 동일한 형식
- 증권사 HTS/MTS에서 날짜별로 주문 체결 내역 다운로드
- 자동화 스크립트 실행 가능

**2순위**: all-orders.xlsx 상세 분석
- 파일의 실제 데이터 구조 파악
- 종목명, 매매구분 정보가 어디에 있는지 확인
- 커스텀 파싱 로직 개발

---

## 📋 현재 상태

| 날짜 | Trading Report | 시간 정보 | 상태 |
|------|----------------|-----------|------|
| 2025-10-23 | ✅ 있음 | ❌ 없음 | 업데이트 필요 |
| 2025-10-27 | ✅ 있음 | ❌ 없음 | 업데이트 필요 |
| 2025-10-28 | ✅ 있음 | ❌ 없음 | 업데이트 필요 |
| 2025-10-29 | ✅ 있음 | ❌ 없음 | 업데이트 필요 |
| 2025-10-30 | ✅ 있음 | ❌ 없음 | 업데이트 필요 |
| 2025-10-31 | ✅ 있음 | ❌ 없음 | 업데이트 필요 |
| 2025-11-03 | ✅ 있음 | ❌ 없음 | 업데이트 필요 |
| 2025-11-04 | ✅ 있음 | ❌ 없음 | 업데이트 필요 |
| 2025-11-05 | ✅ 있음 | ✅ **있음** | ✅ **완료** |

---

## 🔧 다음 단계

1. **확인 필요**: all-orders.xlsx가 어떤 프로그램/시스템에서 생성되었는지?
2. **파일 확보**: 각 날짜별 2025-MM-DD.xlsx 파일 생성 가능한지?
3. **스크립트 실행**: 파일이 준비되면 자동 업데이트 가능

---

*🤖 Generated with Claude Code*
*Updated: 2025-11-05*
