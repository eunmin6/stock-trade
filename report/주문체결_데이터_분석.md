# 주문 체결 데이터 분석 및 활용 방안

**분석 일시**: 2025-11-05
**데이터 소스**: `data/orders/2025-11-05.xlsx`

---

## 📊 데이터 구조

### 포함된 컬럼 (17개)
| 번호 | 컬럼명 | 설명 | 데이터 타입 |
|:----:|--------|------|------------|
| 1 | 주문번호 | 고유 주문 식별자 | 숫자 |
| 2 | 종목코드 | 6자리 종목 코드 | 숫자 |
| 3 | 종목명 | 종목 한글명 | 텍스트 |
| 4 | 구분 | 매수/매도/정정/취소 등 | 텍스트 |
| 5 | 주문가격 | 주문 시 지정 가격 | 숫자 |
| 6 | 주문수량 | 주문한 수량 | 숫자 |
| 7 | 체결가격 | 실제 체결된 가격 | 숫자 |
| 8 | 체결수량 | 실제 체결된 수량 | 숫자 |
| 9 | 미체결 | 미체결 수량 | 숫자 |
| 10 | 체결금액 | 체결가격 × 체결수량 | 숫자 |
| 11 | 수수료 | 거래 수수료 | 숫자 |
| 12 | 상태 | 체결/미체결/확인 | 텍스트 |
| 13 | 주문유형 | 일반/조건 등 | 텍스트 |
| 14 | 원주문번호 | 정정/취소 시 원 주문 | 숫자 |
| 15 | 주문시간 | HH:MM:SS 형식 | 시간 |
| 16 | 종목코드2 | 종목코드 중복 | 숫자 |
| 17 | 시장구분 | KRX 등 | 텍스트 |

---

## 📈 2025-11-05 거래 현황

### 기본 통계
- **총 주문 건수**: 194건
- **거래 종목 수**: 8개
- **체결 건수**: 83건 (42.8%)
- **미체결 건수**: 57건 (29.4%)
- **확인 건수**: 54건 (27.8%)

### 매매 구분
| 구분 | 건수 | 비율 |
|------|-----:|-----:|
| 매수 | 67건 | 34.5% |
| 매도 | 52건 | 26.8% |
| 매도정정 | 25건 | 12.9% |
| 매수정정 | 25건 | 12.9% |
| 매도취소 | 15건 | 7.7% |
| 매수정정취소 | 6건 | 3.1% |
| 매수취소정정 | 3건 | 1.5% |
| 매도취소정정 | 1건 | 0.5% |

### 거래 종목 상세
| 종목코드 | 종목명 | 주문 건수 |
|:--------:|--------|----------:|
| 353200 | 대덕전자 | 66건 (34.0%) |
| 486990 | 노타 | 39건 (20.1%) |
| 92200 | 디아이씨 | 35건 (18.0%) |
| 88340 | 유라클 | 21건 (10.8%) |
| 114190 | 강원에너지 | 15건 (7.7%) |
| 47920 | HLB제약 | 8건 (4.1%) |
| 356680 | 엑스게이트 | 6건 (3.1%) |
| 249420 | 일동제약 | 4건 (2.1%) |

### 시간대별 거래 분포
| 시간대 | 주문 건수 | 특징 |
|--------|----------:|------|
| 09시대 | 33건 | 장 초반 활발 |
| 10시대 | 21건 | - |
| 11시대 | 27건 | - |
| 12시대 | 18건 | 점심 시간 감소 |
| 13시대 | 23건 | - |
| 14시대 | 54건 | **가장 활발** |
| 15시대 | 18건 | 장 마감 |

---

## 💡 데이터 활용 방안

### 1. 실시간 거래 모니터링
**목적**: 주문 체결률 및 슬리피지 추적

**활용 방법**:
```python
# 체결률 계산
체결률 = 체결건수 / 총주문건수 × 100
슬리피지 = abs(주문가격 - 체결가격) / 주문가격 × 100

# 미체결 알림
if 미체결 > 일정시간:
    알림("미체결 주문 확인 필요")
```

**기대 효과**:
- 체결률 42.8%로 낮음 → 주문가격 전략 개선 필요
- 미체결 건수 모니터링으로 손실 기회 최소화

### 2. 주문 패턴 분석
**목적**: 비효율적인 주문 패턴 식별

**분석 포인트**:
- **정정/취소가 많은 종목**: 대덕전자(66건), 노타(39건)
  → 가격 변동성이 크거나 주문 전략 미흡
- **14시대 집중**: 54건(27.8%)
  → 장 후반 매매 집중 전략 사용 중

**개선 방안**:
1. 정정/취소 비율이 높은 종목은 주문가격 설정 개선
2. 시간대 분산 투자로 리스크 분산
3. 14시대 집중 매매의 수익성 검증 필요

### 3. 체결 성과 분석
**목적**: 종목별/시간대별 체결률 비교

**분석 예시**:
```python
# 종목별 체결률
종목별_체결률 = df.groupby('종목명').agg({
    '상태': lambda x: (x == '체결').sum() / len(x) * 100
})

# 시간대별 체결률
시간대별_체결률 = df.groupby('시간대').agg({
    '상태': lambda x: (x == '체결').sum() / len(x) * 100
})
```

**활용**:
- 체결률이 낮은 종목 → 유동성 부족, 호가 전략 변경
- 체결률이 높은 시간대 → 해당 시간에 중요 거래 집중

### 4. 거래 비용 분석
**목적**: 수수료 및 슬리피지 최적화

**활용 방법**:
```python
# 총 거래 비용
총_수수료 = df['수수료'].sum()
총_슬리피지 = abs(df['주문가격'] - df['체결가격']).sum()
총_거래비용 = 총_수수료 + 총_슬리피지

# 종목별 비용 효율성
비용_효율성 = 총_거래비용 / 총_체결금액 × 100
```

**개선 방안**:
- 고비용 종목 식별 및 대체 전략
- 수수료 최적화 (거래량 조정, 시간대 선택)

### 5. 자동매매 시스템 개선
**목적**: 주문 실행 전략 최적화

**데이터 기반 개선**:
1. **주문가격 설정 알고리즘**
   - 체결가격과 주문가격 차이 분석
   - 종목별 최적 호가 스프레드 계산

2. **주문 타이밍 최적화**
   - 시간대별 체결률 기반 주문 시간 조정
   - 14시대 집중 현상 분석 및 개선

3. **정정/취소 자동화**
   - 미체결 시간 임계값 설정
   - 자동 정정 로직 구현

### 6. 성과 리포트 자동화
**목적**: 일일 거래 성과 자동 집계

**리포트 항목**:
```markdown
## 일일 거래 리포트 (YYYY-MM-DD)

### 거래 요약
- 총 주문: XX건
- 체결: XX건 (XX%)
- 미체결: XX건
- 거래 종목: X개

### 종목별 체결 현황
| 종목 | 주문 | 체결 | 체결률 |
|------|------|------|--------|
| ... | ... | ... | ... |

### 시간대별 활동
- 최다 거래 시간대: XX시
- 체결률이 높은 시간대: XX시

### 비용 분석
- 총 수수료: XXX원
- 평균 슬리피지: X.XX%
```

### 7. 전략 백테스팅
**목적**: 과거 주문 데이터 기반 전략 검증

**활용 방법**:
- 주문 체결 데이터와 실제 손익 데이터 결합
- 주문 타이밍별 수익률 분석
- 정정/취소가 성과에 미친 영향 분석

**예시**:
```python
# 정정이 수익에 미친 영향
정정_전_예상수익 = 원주문가격 × 수량
정정_후_실제수익 = 체결가격 × 수량
정정_효과 = 정정_후_실제수익 - 정정_전_예상수익
```

---

## 🎯 즉시 실행 가능한 개선 사항

### 1. 체결률 향상
**현황**: 체결률 42.8% (미체결 57.2%)
**목표**: 체결률 70% 이상

**실행 방안**:
- 호가 스프레드 조정 (더 유리한 가격으로 주문)
- 주문 수량 분할 (대량 주문 시)
- 시장가 주문 비중 확대 (긴급 체결 필요 시)

### 2. 정정/취소 감소
**현황**: 정정/취소 75건 (38.7%)
**목표**: 정정/취소 20% 이하

**실행 방안**:
- 초기 주문가격 정확도 향상
- 시장 상황 분석 강화 (주문 전)
- 자동 정정 로직 최적화

### 3. 시간대 최적화
**현황**: 14시대 54건 집중 (27.8%)
**분석 필요**: 14시대 집중이 수익성이 높은지 검증

**실행 방안**:
- 시간대별 수익률 분석
- 분산 투자 전략 테스트
- 최적 거래 시간대 발굴

---

## 📌 결론

### 주문 체결 데이터의 가치
1. **실시간 모니터링**: 거래 실행 품질 추적
2. **패턴 분석**: 비효율 식별 및 개선
3. **비용 최적화**: 수수료/슬리피지 절감
4. **자동화 개선**: 알고리즘 트레이딩 고도화
5. **성과 측정**: 전략 효과 정량화

### 핵심 인사이트
- ⚠️ **체결률 42.8%는 개선 필요** (목표: 70%+)
- ⚠️ **정정/취소 38.7%는 매우 높음** (비효율)
- 💡 **14시대 거래 집중** (27.8%) → 전략적 판단인지 검증 필요
- 💡 **8개 종목 동시 거래** → 집중 vs 분산 전략 재검토

### 다음 단계
1. ✅ 주문 체결 데이터 일일 수집 자동화
2. ✅ 체결률/슬리피지 대시보드 구축
3. ✅ 종목별/시간대별 성과 분석 리포트 생성
4. ✅ 주문 실행 알고리즘 개선 (체결률 향상)
5. ✅ 거래 비용 최적화 전략 수립

---

*🤖 Generated with Claude Code*
*Updated: 2025-11-05*
